{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Krishna/Internships/Internship%20Assignments/v0-creator-joy-studio-landing-page/app/api/search-trends/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\"\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const body = await request.json()\r\n    console.log(\"üì• Received trend search request:\", body)\r\n\r\n    const { query, platform, category, userId } = body\r\n\r\n    // Try calling n8n webhook first\r\n    let webhookSuccess = false\r\n    let webhookData = null\r\n    \r\n    try {\r\n      const n8nWebhookUrl = process.env.N8N_WEBHOOK_URL || 'http://localhost:5678/webhook/search-trends'\r\n      console.log(\"üîó Calling n8n webhook:\", n8nWebhookUrl)\r\n      \r\n      const webhookResponse = await fetch(n8nWebhookUrl, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify({\r\n          query: query,\r\n          platform: platform,\r\n          category: category,\r\n          userId: userId\r\n        }),\r\n        signal: AbortSignal.timeout(10000) // 10 second timeout\r\n      })\r\n\r\n      if (webhookResponse.ok) {\r\n        webhookData = await webhookResponse.json()\r\n        webhookSuccess = true\r\n        console.log(\"‚úÖ n8n webhook successful\")\r\n        \r\n        return NextResponse.json({\r\n          success: true,\r\n          message: `Found ${webhookData.topics?.length || 0} trending topics`,\r\n          topics: webhookData.topics || [],\r\n          source: \"n8n-webhook\",\r\n          metadata: {\r\n            userId: userId,\r\n            query: query,\r\n            platform: platform,\r\n            category: category,\r\n            totalResults: webhookData.topics?.length || 0\r\n          }\r\n        })\r\n      } else {\r\n        console.warn(\"‚ö†Ô∏è n8n webhook returned error:\", webhookResponse.status)\r\n      }\r\n    } catch (webhookError) {\r\n      console.error(\"‚ùå n8n webhook failed:\", webhookError)\r\n    }\r\n\r\n    // Fallback to mock data if webhook fails\r\n    console.log(\"üîÑ Using mock data fallback\")\r\n    await new Promise(resolve => setTimeout(resolve, 3000))\r\n\r\n    const trendingTopics = [\r\n      {\r\n        id: `trend_1_${Date.now()}`,\r\n        topic: `${query} - Latest Innovations`,\r\n        platform: platform === \"all\" ? \"LinkedIn\" : platform,\r\n        engagement: Math.floor(Math.random() * 50000) + 10000,\r\n        views: Math.floor(Math.random() * 500000) + 100000,\r\n        posts: Math.floor(Math.random() * 5000) + 1000,\r\n        growthRate: `+${Math.floor(Math.random() * 50) + 20}%`,\r\n        category: category === \"all\" ? \"technology\" : category,\r\n        keywords: [\r\n          query.split(\" \")[0],\r\n          \"innovation\",\r\n          \"2025\",\r\n          \"trending\",\r\n          \"viral\"\r\n        ],\r\n        suggestedContent: `Create a carousel post highlighting the top 5 ${query} trends in 2025. Include statistics, expert quotes, and actionable insights. End with a call-to-action asking followers to share their experiences.`,\r\n        bestTimeToPost: \"Tuesday, 10:00 AM - 12:00 PM\",\r\n        targetAudience: \"Professionals aged 25-45\"\r\n      },\r\n      {\r\n        id: `trend_2_${Date.now()}`,\r\n        topic: `How ${query} is Transforming Business`,\r\n        platform: platform === \"all\" ? \"Instagram\" : platform,\r\n        engagement: Math.floor(Math.random() * 40000) + 8000,\r\n        views: Math.floor(Math.random() * 400000) + 80000,\r\n        posts: Math.floor(Math.random() * 4000) + 800,\r\n        growthRate: `+${Math.floor(Math.random() * 40) + 15}%`,\r\n        category: category === \"all\" ? \"business\" : category,\r\n        keywords: [\r\n          \"transformation\",\r\n          \"digital\",\r\n          \"strategy\",\r\n          \"growth\",\r\n          \"innovation\"\r\n        ],\r\n        suggestedContent: `Share a short 60-second video explaining how ${query} is revolutionizing your industry. Use dynamic visuals, on-screen text, and trending audio. Include a before/after comparison for maximum impact.`,\r\n        bestTimeToPost: \"Wednesday, 7:00 PM - 9:00 PM\",\r\n        targetAudience: \"Business owners aged 30-50\"\r\n      },\r\n      {\r\n        id: `trend_3_${Date.now()}`,\r\n        topic: `${query} Success Stories & Case Studies`,\r\n        platform: platform === \"all\" ? \"YouTube\" : platform,\r\n        engagement: Math.floor(Math.random() * 60000) + 15000,\r\n        views: Math.floor(Math.random() * 600000) + 150000,\r\n        posts: Math.floor(Math.random() * 6000) + 1500,\r\n        growthRate: `+${Math.floor(Math.random() * 60) + 25}%`,\r\n        category: category === \"all\" ? \"marketing\" : category,\r\n        keywords: [\r\n          \"success\",\r\n          \"case study\",\r\n          \"results\",\r\n          \"ROI\",\r\n          \"implementation\"\r\n        ],\r\n        suggestedContent: `Create a 10-minute deep-dive video featuring real ${query} success stories. Interview industry leaders, show metrics, and provide step-by-step implementation tips. Optimize for SEO with timestamps and chapters.`,\r\n        bestTimeToPost: \"Thursday, 2:00 PM - 4:00 PM\",\r\n        targetAudience: \"Decision makers aged 35-55\"\r\n      },\r\n      {\r\n        id: `trend_4_${Date.now()}`,\r\n        topic: `Top 10 ${query} Tools & Resources`,\r\n        platform: platform === \"all\" ? \"LinkedIn\" : platform,\r\n        engagement: Math.floor(Math.random() * 45000) + 9000,\r\n        views: Math.floor(Math.random() * 450000) + 90000,\r\n        posts: Math.floor(Math.random() * 4500) + 900,\r\n        growthRate: `+${Math.floor(Math.random() * 45) + 18}%`,\r\n        category: category === \"all\" ? \"technology\" : category,\r\n        keywords: [\r\n          \"tools\",\r\n          \"resources\",\r\n          \"productivity\",\r\n          \"software\",\r\n          \"automation\"\r\n        ],\r\n        suggestedContent: `Create an infographic listing the top 10 ${query} tools with pros, cons, and pricing. Include a comparison table and your personal recommendation. Encourage engagement by asking which tool followers use.`,\r\n        bestTimeToPost: \"Monday, 9:00 AM - 11:00 AM\",\r\n        targetAudience: \"Tech professionals aged 25-40\"\r\n      },\r\n      {\r\n        id: `trend_5_${Date.now()}`,\r\n        topic: `${query} Mistakes to Avoid in 2025`,\r\n        platform: platform === \"all\" ? \"Instagram\" : platform,\r\n        engagement: Math.floor(Math.random() * 35000) + 7000,\r\n        views: Math.floor(Math.random() * 350000) + 70000,\r\n        posts: Math.floor(Math.random() * 3500) + 700,\r\n        growthRate: `+${Math.floor(Math.random() * 35) + 12}%`,\r\n        category: category === \"all\" ? \"education\" : category,\r\n        keywords: [\r\n          \"mistakes\",\r\n          \"avoid\",\r\n          \"tips\",\r\n          \"lessons\",\r\n          \"best practices\"\r\n        ],\r\n        suggestedContent: `Create a Reel highlighting the top 5 ${query} mistakes people make. Use bold text overlays, trending transitions, and a relatable hook. End with a free checklist download to capture leads.`,\r\n        bestTimeToPost: \"Friday, 6:00 PM - 8:00 PM\",\r\n        targetAudience: \"Beginners & enthusiasts aged 20-35\"\r\n      }\r\n    ]\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: `‚ö†Ô∏è Webhook failed - showing ${trendingTopics.length} mock trending topics`,\r\n      warning: \"n8n webhook is currently unavailable. Displaying sample data for demonstration purposes.\",\r\n      topics: trendingTopics,\r\n      source: \"mock-fallback\",\r\n      metadata: {\r\n        userId: userId,\r\n        query: query,\r\n        platform: platform,\r\n        category: category,\r\n        searchTime: \"3.0s\",\r\n        totalResults: trendingTopics.length,\r\n        webhookStatus: \"failed\"\r\n      }\r\n    })\r\n  } catch (error) {\r\n    console.error(\"‚ùå Trend search error:\", error)\r\n    return NextResponse.json(\r\n      { success: false, error: \"Failed to search trends\" },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,QAAQ,GAAG,CAAC,qCAAqC;QAEjD,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE,MAAM,EAAE,GAAG;QAE9C,gCAAgC;QAChC,IAAI,iBAAiB;QACrB,IAAI,cAAc;QAElB,IAAI;YACF,MAAM,gBAAgB,QAAQ,GAAG,CAAC,eAAe,IAAI;YACrD,QAAQ,GAAG,CAAC,2BAA2B;YAEvC,MAAM,kBAAkB,MAAM,MAAM,eAAe;gBACjD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,OAAO;oBACP,UAAU;oBACV,UAAU;oBACV,QAAQ;gBACV;gBACA,QAAQ,YAAY,OAAO,CAAC,OAAO,oBAAoB;YACzD;YAEA,IAAI,gBAAgB,EAAE,EAAE;gBACtB,cAAc,MAAM,gBAAgB,IAAI;gBACxC,iBAAiB;gBACjB,QAAQ,GAAG,CAAC;gBAEZ,OAAO,gJAAY,CAAC,IAAI,CAAC;oBACvB,SAAS;oBACT,SAAS,CAAC,MAAM,EAAE,YAAY,MAAM,EAAE,UAAU,EAAE,gBAAgB,CAAC;oBACnE,QAAQ,YAAY,MAAM,IAAI,EAAE;oBAChC,QAAQ;oBACR,UAAU;wBACR,QAAQ;wBACR,OAAO;wBACP,UAAU;wBACV,UAAU;wBACV,cAAc,YAAY,MAAM,EAAE,UAAU;oBAC9C;gBACF;YACF,OAAO;gBACL,QAAQ,IAAI,CAAC,kCAAkC,gBAAgB,MAAM;YACvE;QACF,EAAE,OAAO,cAAc;YACrB,QAAQ,KAAK,CAAC,yBAAyB;QACzC;QAEA,yCAAyC;QACzC,QAAQ,GAAG,CAAC;QACZ,MAAM,IAAI,QAAQ,CAAA,UAAW,WAAW,SAAS;QAEjD,MAAM,iBAAiB;YACrB;gBACE,IAAI,CAAC,QAAQ,EAAE,KAAK,GAAG,IAAI;gBAC3B,OAAO,GAAG,MAAM,qBAAqB,CAAC;gBACtC,UAAU,aAAa,QAAQ,aAAa;gBAC5C,YAAY,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;gBAChD,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,UAAU;gBAC5C,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ;gBAC1C,YAAY,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,GAAG,CAAC,CAAC;gBACtD,UAAU,aAAa,QAAQ,eAAe;gBAC9C,UAAU;oBACR,MAAM,KAAK,CAAC,IAAI,CAAC,EAAE;oBACnB;oBACA;oBACA;oBACA;iBACD;gBACD,kBAAkB,CAAC,8CAA8C,EAAE,MAAM,mJAAmJ,CAAC;gBAC7N,gBAAgB;gBAChB,gBAAgB;YAClB;YACA;gBACE,IAAI,CAAC,QAAQ,EAAE,KAAK,GAAG,IAAI;gBAC3B,OAAO,CAAC,IAAI,EAAE,MAAM,yBAAyB,CAAC;gBAC9C,UAAU,aAAa,QAAQ,cAAc;gBAC7C,YAAY,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;gBAChD,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,UAAU;gBAC5C,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ;gBAC1C,YAAY,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,GAAG,CAAC,CAAC;gBACtD,UAAU,aAAa,QAAQ,aAAa;gBAC5C,UAAU;oBACR;oBACA;oBACA;oBACA;oBACA;iBACD;gBACD,kBAAkB,CAAC,6CAA6C,EAAE,MAAM,iJAAiJ,CAAC;gBAC1N,gBAAgB;gBAChB,gBAAgB;YAClB;YACA;gBACE,IAAI,CAAC,QAAQ,EAAE,KAAK,GAAG,IAAI;gBAC3B,OAAO,GAAG,MAAM,+BAA+B,CAAC;gBAChD,UAAU,aAAa,QAAQ,YAAY;gBAC3C,YAAY,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;gBAChD,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,UAAU;gBAC5C,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ;gBAC1C,YAAY,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,GAAG,CAAC,CAAC;gBACtD,UAAU,aAAa,QAAQ,cAAc;gBAC7C,UAAU;oBACR;oBACA;oBACA;oBACA;oBACA;iBACD;gBACD,kBAAkB,CAAC,kDAAkD,EAAE,MAAM,wJAAwJ,CAAC;gBACtO,gBAAgB;gBAChB,gBAAgB;YAClB;YACA;gBACE,IAAI,CAAC,QAAQ,EAAE,KAAK,GAAG,IAAI;gBAC3B,OAAO,CAAC,OAAO,EAAE,MAAM,kBAAkB,CAAC;gBAC1C,UAAU,aAAa,QAAQ,aAAa;gBAC5C,YAAY,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;gBAChD,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,UAAU;gBAC5C,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ;gBAC1C,YAAY,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,GAAG,CAAC,CAAC;gBACtD,UAAU,aAAa,QAAQ,eAAe;gBAC9C,UAAU;oBACR;oBACA;oBACA;oBACA;oBACA;iBACD;gBACD,kBAAkB,CAAC,yCAAyC,EAAE,MAAM,0JAA0J,CAAC;gBAC/N,gBAAgB;gBAChB,gBAAgB;YAClB;YACA;gBACE,IAAI,CAAC,QAAQ,EAAE,KAAK,GAAG,IAAI;gBAC3B,OAAO,GAAG,MAAM,0BAA0B,CAAC;gBAC3C,UAAU,aAAa,QAAQ,cAAc;gBAC7C,YAAY,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,SAAS;gBAChD,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,UAAU;gBAC5C,OAAO,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,QAAQ;gBAC1C,YAAY,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,KAAK,MAAM,KAAK,MAAM,GAAG,CAAC,CAAC;gBACtD,UAAU,aAAa,QAAQ,cAAc;gBAC7C,UAAU;oBACR;oBACA;oBACA;oBACA;oBACA;iBACD;gBACD,kBAAkB,CAAC,qCAAqC,EAAE,MAAM,+IAA+I,CAAC;gBAChN,gBAAgB;gBAChB,gBAAgB;YAClB;SACD;QAED,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS,CAAC,4BAA4B,EAAE,eAAe,MAAM,CAAC,qBAAqB,CAAC;YACpF,SAAS;YACT,QAAQ;YACR,QAAQ;YACR,UAAU;gBACR,QAAQ;gBACR,OAAO;gBACP,UAAU;gBACV,UAAU;gBACV,YAAY;gBACZ,cAAc,eAAe,MAAM;gBACnC,eAAe;YACjB;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,SAAS;YAAO,OAAO;QAA0B,GACnD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}